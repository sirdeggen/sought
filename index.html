<html>
<head>
  <meta charSet='utf-8' />
  <title>Sought Info</title>
  <meta name='description' content='Open Blog - post here from Baemail.' />
  <meta name='viewport' content='width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no' />
  <link href='https://fonts.googleapis.com/css?family=Fira+Code:300,400,500&display=swap&subset=cyrillic,cyrillic-ext,greek,greek-ext,latin-ext' rel='stylesheet' />
  <link href='https://baemail.me/static/editor/style.css' rel='stylesheet' />
  <link href='https://baemail.me/static/editor/atom-one-dark.css' rel='stylesheet' />
  <link href='css/bootstrap.min.css' rel='stylesheet' />
  <script src='https://www.moneybutton.com/moneybutton.js'></script>
  <script src='https://baemail.me/static/editor/highlight.pack'></script>
</head>
<body>
  <main role="main" class="container">
    <h1 class="mt-5">Sought.Info</h1>
    <p class="lead">Info shared via Baemail. Share your content to this page via <a href='https://baemail.me/?to=sought'>baemail</a>. Posts are ordered by value.</p>
    <div id='target'>
      loading...
    </div>
    <button class='btn-primary' onClick='more()' />More</button>
  </main>
<script>
let skip = 0
let l = 5
function more() {
  // call bob
  var query = {
    'v': 3,
    'q': {
      'find': {
        '$or': [ { 'blk.i': { '$exists': false } }, { 'blk.i': { '$gt': 600439 } } ],
        'out.tape.cell': {
          '$all': [
            { '$elemMatch': { 'i': 0, 's': '1BaesvDkcKN9jyLtVLWsUSTgDPDKSMVAii' } },
            { '$elemMatch': { 'i': 1, 's': { '$regex': 'sought@moneybutton.com' } } },
            { '$elemMatch': { 'i': 4, 's': 'false' } }
          ]
        },
        'tx.h': { '$nin': ['81776549db35f2936317d4803df841bc9104557b92305e20371ac773cff83ea7'] }
      },
      'project': {
        'tx.h': 1, 'out.tape.cell': 1, 'out.e.v': 1
      },
      'sort': {
        'out.e.v': -1
      },
      'skip': skip * l,
      'limit': l
    },
    'r': {
      'f': '[ .[] | [{ to: .out[0].tape[1].cell[1].s, from: .out[0].tape[1].cell[2].s, baemail: (.out[0].tape[1].cell[3].s + .out[0].tape[1].cell[3].ls), tx: .tx.h, amount: .out[1].e.v }] | .[] ]'
    }
  }
  var header = { headers: { key: '1BaesvDkcKN9jyLtVLWsUSTgDPDKSMVAii' } }
  var b64 = btoa(JSON.stringify(query))
  var url = 'https://bob.planaria.network/q/1GgmC7Cg782YtQ6R9QkM58voyWeQJmJJzG/' + b64
  fetch(url, header).then((r) => {
    return r.json()
  }).then((baemails) => {
    skip += 1
    console.log(skip)
    console.log(baemails)
  })
}
more()
</script>
</body>
</html>
